<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VLCB library: event_teach_large.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">VLCB library<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">VLCB C library for PIC</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('event__teach__large_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">event_teach_large.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of the VLCB <a class="el" href="struct_event.html">Event</a> Teach <a class="el" href="struct_service.html">Service</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;xc.h&gt;</code><br />
<code>#include &quot;<a class="el" href="vlcb_8h_source.html">vlcb.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nvm_8h_source.html">nvm.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mns_8h_source.html">mns.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timed_response_8h_source.html">timedResponse.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="event__teach_8h_source.html">event_teach.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="event__producer_8h_source.html">event_producer.h</a>&quot;</code><br />
<code>#include &quot;module.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="union_event_table_flags.html">EventTableFlags</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_event_table.html">EventTable</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1cdd20e3ef223f7ae11e791f60a5a835" id="r_a1cdd20e3ef223f7ae11e791f60a5a835"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1cdd20e3ef223f7ae11e791f60a5a835">EVENTTABLE_OFFSET_FLAGS</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a1cdd20e3ef223f7ae11e791f60a5a835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4a56380432dd046cc09e41b62b9689c" id="r_ad4a56380432dd046cc09e41b62b9689c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad4a56380432dd046cc09e41b62b9689c">EVENTTABLE_OFFSET_NEXT</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ad4a56380432dd046cc09e41b62b9689c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e855a60c5952255d6b2fccdb7b45528" id="r_a3e855a60c5952255d6b2fccdb7b45528"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3e855a60c5952255d6b2fccdb7b45528">EVENTTABLE_OFFSET_NN</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a3e855a60c5952255d6b2fccdb7b45528"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18783131dda4394667f41cb813ad21f7" id="r_a18783131dda4394667f41cb813ad21f7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a18783131dda4394667f41cb813ad21f7">EVENTTABLE_OFFSET_EN</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a18783131dda4394667f41cb813ad21f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7260c350fcb83f00a88e51a4315e27da" id="r_a7260c350fcb83f00a88e51a4315e27da"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7260c350fcb83f00a88e51a4315e27da">EVENTTABLE_OFFSET_EVS</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:a7260c350fcb83f00a88e51a4315e27da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06ff2b325b362e13f9e570d530089563" id="r_a06ff2b325b362e13f9e570d530089563"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a06ff2b325b362e13f9e570d530089563">EVENTTABLE_ROW_WIDTH</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a06ff2b325b362e13f9e570d530089563"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6cb9b05ea204a7905d0ae0143950a03" id="r_ab6cb9b05ea204a7905d0ae0143950a03"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab6cb9b05ea204a7905d0ae0143950a03">NO_INDEX</a>&#160;&#160;&#160;0xff</td></tr>
<tr class="separator:ab6cb9b05ea204a7905d0ae0143950a03"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9bf07c27105f7c54f030818acb9ad9d1" id="r_a9bf07c27105f7c54f030818acb9ad9d1"><td class="memItemLeft" align="right" valign="top"><a id="a9bf07c27105f7c54f030818acb9ad9d1" name="a9bf07c27105f7c54f030818acb9ad9d1"></a>
<a class="el" href="vlcb_8h.html#a60587b24892ebc76ee16bbfdb4d52544">Processed</a>&#160;</td><td class="memItemRight" valign="bottom"><b>checkLen</b> (<a class="el" href="struct_message.html">Message</a> *m, uint8_t needed, uint8_t service)</td></tr>
<tr class="separator:a9bf07c27105f7c54f030818acb9ad9d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7afd0605b0c9b64d0aec16c7e8ac562c" id="r_a7afd0605b0c9b64d0aec16c7e8ac562c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="timed_response_8h.html#a34f3661bc164f76318500bd6a0fafd48">TimedResponseResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7afd0605b0c9b64d0aec16c7e8ac562c">nerdCallback</a> (uint8_t type, uint8_t serviceIndex, uint8_t step)</td></tr>
<tr class="separator:a7afd0605b0c9b64d0aec16c7e8ac562c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a119c32fa845221e45656dcbc493732c5" id="r_a119c32fa845221e45656dcbc493732c5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="timed_response_8h.html#a34f3661bc164f76318500bd6a0fafd48">TimedResponseResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a119c32fa845221e45656dcbc493732c5">reqevCallback</a> (uint8_t type, uint8_t serviceIndex, uint8_t step)</td></tr>
<tr class="separator:a119c32fa845221e45656dcbc493732c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a722d9dbb962714dab2dbed9aee2cba" id="r_a4a722d9dbb962714dab2dbed9aee2cba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="vlcb_8h.html#ae7d38601dfbd73adbe5c1b3ec34e0e13">Boolean</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a722d9dbb962714dab2dbed9aee2cba">validStart</a> (uint8_t tableIndex)</td></tr>
<tr class="separator:a4a722d9dbb962714dab2dbed9aee2cba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ecc0cd4c43c7100796706b8b415d9fc" id="r_a0ecc0cd4c43c7100796706b8b415d9fc"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ecc0cd4c43c7100796706b8b415d9fc">getNN</a> (uint8_t tableIndex)</td></tr>
<tr class="separator:a0ecc0cd4c43c7100796706b8b415d9fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa1bcfeab543550146f0b9d15b4a1222" id="r_aaa1bcfeab543550146f0b9d15b4a1222"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaa1bcfeab543550146f0b9d15b4a1222">getEN</a> (uint8_t tableIndex)</td></tr>
<tr class="separator:aaa1bcfeab543550146f0b9d15b4a1222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec14aa1580e747e31f46541a2bde4279" id="r_aec14aa1580e747e31f46541a2bde4279"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aec14aa1580e747e31f46541a2bde4279">numEv</a> (uint8_t tableIndex)</td></tr>
<tr class="separator:aec14aa1580e747e31f46541a2bde4279"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37e3faf0772321f16d80d7b2db753d92" id="r_a37e3faf0772321f16d80d7b2db753d92"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a37e3faf0772321f16d80d7b2db753d92">getEv</a> (uint8_t tableIndex, uint8_t evNum)</td></tr>
<tr class="separator:a37e3faf0772321f16d80d7b2db753d92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef79de314cb4fdf348009d498ad5cbc6" id="r_aef79de314cb4fdf348009d498ad5cbc6"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aef79de314cb4fdf348009d498ad5cbc6">findEvent</a> (uint16_t nodeNumber, uint16_t eventNumber)</td></tr>
<tr class="separator:aef79de314cb4fdf348009d498ad5cbc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86e94e6b99175b437fb4fadc603e54a2" id="r_a86e94e6b99175b437fb4fadc603e54a2"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a86e94e6b99175b437fb4fadc603e54a2">removeEvent</a> (uint16_t nodeNumber, uint16_t eventNumber)</td></tr>
<tr class="separator:a86e94e6b99175b437fb4fadc603e54a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ccf826767b71505fb4b5ffb2b4ff5af" id="r_a2ccf826767b71505fb4b5ffb2b4ff5af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2ccf826767b71505fb4b5ffb2b4ff5af">checkRemoveTableEntry</a> (uint8_t tableIndex)</td></tr>
<tr class="separator:a2ccf826767b71505fb4b5ffb2b4ff5af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0c26a766be6cd890ea7e04b18e54cd5" id="r_ab0c26a766be6cd890ea7e04b18e54cd5"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab0c26a766be6cd890ea7e04b18e54cd5">addEvent</a> (uint16_t nodeNumber, uint16_t eventNumber, uint8_t evNum, uint8_t evVal, <a class="el" href="vlcb_8h.html#ae7d38601dfbd73adbe5c1b3ec34e0e13">Boolean</a> forceOwnNN)</td></tr>
<tr class="separator:ab0c26a766be6cd890ea7e04b18e54cd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad66c29cafca265754d755a5129120df7" id="r_ad66c29cafca265754d755a5129120df7"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad66c29cafca265754d755a5129120df7">writeEv</a> (uint8_t tableIndex, uint8_t evNum, uint8_t evVal)</td></tr>
<tr class="separator:ad66c29cafca265754d755a5129120df7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a275d5d58705f018ba8ea8a05477ba716" id="r_a275d5d58705f018ba8ea8a05477ba716"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a275d5d58705f018ba8ea8a05477ba716">getEVs</a> (uint8_t tableIndex)</td></tr>
<tr class="separator:a275d5d58705f018ba8ea8a05477ba716"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a25dbd341349525d3b0917340575378b7" id="r_a25dbd341349525d3b0917340575378b7"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="struct_service.html">Service</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a25dbd341349525d3b0917340575378b7">eventTeachService</a></td></tr>
<tr class="separator:a25dbd341349525d3b0917340575378b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e104ea2eb5211e43dd69e1092a236a3" id="r_a5e104ea2eb5211e43dd69e1092a236a3"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5e104ea2eb5211e43dd69e1092a236a3">evs</a> [PARAM_NUM_EV_EVENT]</td></tr>
<tr class="separator:a5e104ea2eb5211e43dd69e1092a236a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of the VLCB <a class="el" href="struct_event.html">Event</a> Teach <a class="el" href="struct_service.html">Service</a>. </p>
<dl class="section copyright"><dt>Copyright</dt><dd>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Pete Brownlow </dd>
<dd>
Ian Hogg </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Dec 2022</dd></dl>
<p><a class="el" href="struct_event.html">Event</a> teaching service The service definition object is called eventTeachService.</p>
<p>The events are stored as a hash table in flash (flash is faster to read than EEPROM) There can be up to 255 events. Since the address in the hash table will be 16 bits, and the address of the whole event table can also be covered by a 16 bit address, there is no advantage in having a separate hashed index table pointing to the actual event table. Therefore the hashing algorithm produces the index into the actual event table, which can be shifted to give the address - each event table entry is 16 bytes. After the event number and hash table overhead, this allows up to 10 EVs per event.</p>
<p>This generic code needs no knowledge of specific EV usage.</p>
<dl class="section warning"><dt>Warning</dt><dd>BEWARE must set NUM_EVENTS to a maximum of 255! If set to 256 then the for (uint8_t i=0; i&lt;NUM_EVENTS; i++) loops will never end as they use an uint8_t instead of int for space/performance reasons.</dd>
<dd>
BEWARE Concurrency: The functions which use the eventtable and hash/lookup must not be used whilst there is a chance of the functions which modify the eventtable of RAM based hash/lookup tables being called. These functions should therefore either be called from the same thread or disable interrupts.</dd></dl>
<h1><a class="anchor" id="autotoc_md17"></a>
Module.h definitions required for the Event Teach service</h1>
<ul>
<li>#define EVENT_TABLE_WIDTH This the the width of the table - not the number of EVs per event as multiple rows in the table can be used to store an event.</li>
<li>#define NUM_EVENTS The number of rows in the event table. The actual number of events may be less than this if any events use more the 1 row.</li>
<li>#define EVENT_TABLE_ADDRESS The address where the event table is stored.</li>
<li>#define EVENT_TABLE_NVM_TYPE Set to be either FLASH_NVM_TYPE or EEPROM_NVM_TYPE</li>
<li>#define EVENT_HASH_TABLE If defined then hash tables will be used for quicker lookup of events at the expense of additional RAM.</li>
<li>#define EVENT_HASH_LENGTH If hash tables are used then this sets the length of the hash.</li>
<li>#define EVENT_CHAIN_LENGTH If hash tables are used then this sets the number of events in the hash chain.</li>
<li>#define MAX_HAPPENING Set to be the maximum Happening value</li>
</ul>
<p>The code is responsible for storing EVs for each defined event and also for allowing speedy lookup of EVs given an <a class="el" href="struct_event.html">Event</a> or finding an <a class="el" href="struct_event.html">Event</a> given a Happening which is stored in the first EVs. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a18783131dda4394667f41cb813ad21f7" name="a18783131dda4394667f41cb813ad21f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18783131dda4394667f41cb813ad21f7">&#9670;&#160;</a></span>EVENTTABLE_OFFSET_EN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EVENTTABLE_OFFSET_EN&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Byte index into an <a class="el" href="struct_event_table.html">EventTable</a> row to access the event en element. </p>

</div>
</div>
<a id="a7260c350fcb83f00a88e51a4315e27da" name="a7260c350fcb83f00a88e51a4315e27da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7260c350fcb83f00a88e51a4315e27da">&#9670;&#160;</a></span>EVENTTABLE_OFFSET_EVS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EVENTTABLE_OFFSET_EVS&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Byte index into an <a class="el" href="struct_event_table.html">EventTable</a> row to access the event variables. </p>

</div>
</div>
<a id="a1cdd20e3ef223f7ae11e791f60a5a835" name="a1cdd20e3ef223f7ae11e791f60a5a835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cdd20e3ef223f7ae11e791f60a5a835">&#9670;&#160;</a></span>EVENTTABLE_OFFSET_FLAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EVENTTABLE_OFFSET_FLAGS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Byte index into an <a class="el" href="struct_event_table.html">EventTable</a> row to access the flags element. </p>

</div>
</div>
<a id="ad4a56380432dd046cc09e41b62b9689c" name="ad4a56380432dd046cc09e41b62b9689c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4a56380432dd046cc09e41b62b9689c">&#9670;&#160;</a></span>EVENTTABLE_OFFSET_NEXT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EVENTTABLE_OFFSET_NEXT&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Byte index into an <a class="el" href="struct_event_table.html">EventTable</a> row to access the next element. </p>

</div>
</div>
<a id="a3e855a60c5952255d6b2fccdb7b45528" name="a3e855a60c5952255d6b2fccdb7b45528"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e855a60c5952255d6b2fccdb7b45528">&#9670;&#160;</a></span>EVENTTABLE_OFFSET_NN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EVENTTABLE_OFFSET_NN&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Byte index into an <a class="el" href="struct_event_table.html">EventTable</a> row to access the event nn element. </p>

</div>
</div>
<a id="a06ff2b325b362e13f9e570d530089563" name="a06ff2b325b362e13f9e570d530089563"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06ff2b325b362e13f9e570d530089563">&#9670;&#160;</a></span>EVENTTABLE_ROW_WIDTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EVENTTABLE_ROW_WIDTH&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Total number of bytes in an <a class="el" href="struct_event_table.html">EventTable</a> row. </p>

</div>
</div>
<a id="ab6cb9b05ea204a7905d0ae0143950a03" name="ab6cb9b05ea204a7905d0ae0143950a03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6cb9b05ea204a7905d0ae0143950a03">&#9670;&#160;</a></span>NO_INDEX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NO_INDEX&#160;&#160;&#160;0xff</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Represents an invalid index into the <a class="el" href="struct_event_table.html">EventTable</a>. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab0c26a766be6cd890ea7e04b18e54cd5" name="ab0c26a766be6cd890ea7e04b18e54cd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0c26a766be6cd890ea7e04b18e54cd5">&#9670;&#160;</a></span>addEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t addEvent </td>
          <td>(</td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>nodeNumber</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>eventNumber</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>evNum</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>evVal</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="vlcb_8h.html#ae7d38601dfbd73adbe5c1b3ec34e0e13">Boolean</a></td>          <td class="paramname"><span class="paramname"><em>forceOwnNN</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add an event/EV. Teach or re-teach an EV for an event. This may (optionally) need to create a new event and then optionally create additional chained entries. All newly allocated table entries need to be initialised.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nodeNumber</td><td><a class="el" href="struct_event.html">Event</a> NN </td></tr>
    <tr><td class="paramname">eventNumber</td><td><a class="el" href="struct_event.html">Event</a> NN </td></tr>
    <tr><td class="paramname">evNum</td><td>the EV index (starts at 0 for the produced action) </td></tr>
    <tr><td class="paramname">evVal</td><td>the EV value </td></tr>
    <tr><td class="paramname">forceOwnNN</td><td>the value of the flag </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error number or 0 for success </dd></dl>

</div>
</div>
<a id="a2ccf826767b71505fb4b5ffb2b4ff5af" name="a2ccf826767b71505fb4b5ffb2b4ff5af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ccf826767b71505fb4b5ffb2b4ff5af">&#9670;&#160;</a></span>checkRemoveTableEntry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void checkRemoveTableEntry </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>tableIndex</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check to see if any event entries can be removed. Entries can be removed if their EVs are all set to EV_FILL.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tableIndex</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aef79de314cb4fdf348009d498ad5cbc6" name="aef79de314cb4fdf348009d498ad5cbc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef79de314cb4fdf348009d498ad5cbc6">&#9670;&#160;</a></span>findEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t findEvent </td>
          <td>(</td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>nodeNumber</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>eventNumber</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find an event in the event table and return its index.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nodeNumber</td><td>event NN </td></tr>
    <tr><td class="paramname">eventNumber</td><td>event EN </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>index into event table or NO_INDEX if not present </dd></dl>

</div>
</div>
<a id="aaa1bcfeab543550146f0b9d15b4a1222" name="aaa1bcfeab543550146f0b9d15b4a1222"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa1bcfeab543550146f0b9d15b4a1222">&#9670;&#160;</a></span>getEN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t getEN </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>tableIndex</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the EN for an event. Getter so that the application code can obtain information about the event.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tableIndex</td><td>the index of the start of an event </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the <a class="el" href="struct_event.html">Event</a> Number </dd></dl>

</div>
</div>
<a id="a37e3faf0772321f16d80d7b2db753d92" name="a37e3faf0772321f16d80d7b2db753d92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37e3faf0772321f16d80d7b2db753d92">&#9670;&#160;</a></span>getEv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t getEv </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>tableIndex</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>evNum</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return an EV value for an event.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tableIndex</td><td>the index of the start of an event </td></tr>
    <tr><td class="paramname">evNum</td><td>ev number starts at 0 (Happening) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the ev value or -error code if error </dd></dl>

</div>
</div>
<a id="a275d5d58705f018ba8ea8a05477ba716" name="a275d5d58705f018ba8ea8a05477ba716"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a275d5d58705f018ba8ea8a05477ba716">&#9670;&#160;</a></span>getEVs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t getEVs </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>tableIndex</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return all the EV values for an event. EVs are put into the global evs array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tableIndex</td><td>the index of the start of an event </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error code or 0 for no error </dd></dl>

</div>
</div>
<a id="a0ecc0cd4c43c7100796706b8b415d9fc" name="a0ecc0cd4c43c7100796706b8b415d9fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ecc0cd4c43c7100796706b8b415d9fc">&#9670;&#160;</a></span>getNN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t getNN </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>tableIndex</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the NN for an event. Getter so that the application code can obtain information about the event.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tableIndex</td><td>the index of the start of an event </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the Node Number </dd></dl>

</div>
</div>
<a id="a7afd0605b0c9b64d0aec16c7e8ac562c" name="a7afd0605b0c9b64d0aec16c7e8ac562c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7afd0605b0c9b64d0aec16c7e8ac562c">&#9670;&#160;</a></span>nerdCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="timed_response_8h.html#a34f3661bc164f76318500bd6a0fafd48">TimedResponseResult</a> nerdCallback </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>type</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>serviceIndex</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>step</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The callback to do the NERD responses. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>the type of the timedResponse </td></tr>
    <tr><td class="paramname">serviceIndex</td><td>the service </td></tr>
    <tr><td class="paramname">step</td><td>how far through the processing </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether to finish or continue processing </dd></dl>

</div>
</div>
<a id="aec14aa1580e747e31f46541a2bde4279" name="aec14aa1580e747e31f46541a2bde4279"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec14aa1580e747e31f46541a2bde4279">&#9670;&#160;</a></span>numEv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t numEv </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>tableIndex</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of EVs for an event.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tableIndex</td><td>the index of the start of an event </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the number of EVs </dd></dl>

</div>
</div>
<a id="a86e94e6b99175b437fb4fadc603e54a2" name="a86e94e6b99175b437fb4fadc603e54a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86e94e6b99175b437fb4fadc603e54a2">&#9670;&#160;</a></span>removeEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t removeEvent </td>
          <td>(</td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>nodeNumber</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>eventNumber</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove event.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nodeNumber</td><td><a class="el" href="struct_event.html">Event</a> NN </td></tr>
    <tr><td class="paramname">eventNumber</td><td><a class="el" href="struct_event.html">Event</a> EN </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error or 0 for success </dd></dl>

</div>
</div>
<a id="a119c32fa845221e45656dcbc493732c5" name="a119c32fa845221e45656dcbc493732c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a119c32fa845221e45656dcbc493732c5">&#9670;&#160;</a></span>reqevCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="timed_response_8h.html#a34f3661bc164f76318500bd6a0fafd48">TimedResponseResult</a> reqevCallback </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>tableIndex</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>serviceIndex</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>step</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The callback to do the REQEV responses. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tableIndex</td><td>the index of the event in the eventTable </td></tr>
    <tr><td class="paramname">serviceIndex</td><td>the service </td></tr>
    <tr><td class="paramname">step</td><td>how far through the processing, considered to be an EV#-1 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether to finish or continue processing </dd></dl>

</div>
</div>
<a id="a4a722d9dbb962714dab2dbed9aee2cba" name="a4a722d9dbb962714dab2dbed9aee2cba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a722d9dbb962714dab2dbed9aee2cba">&#9670;&#160;</a></span>validStart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="vlcb_8h.html#ae7d38601dfbd73adbe5c1b3ec34e0e13">Boolean</a> validStart </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>tableIndex</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checks if the specified index is the start of a set of linked entries.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tableIndex</td><td>the index into event table to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the specified index is the start of a linked set </dd></dl>

</div>
</div>
<a id="ad66c29cafca265754d755a5129120df7" name="ad66c29cafca265754d755a5129120df7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad66c29cafca265754d755a5129120df7">&#9670;&#160;</a></span>writeEv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t writeEv </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>tableIndex</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>evNum</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>evVal</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write an EV value to an event.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tableIndex</td><td>the index into the event table </td></tr>
    <tr><td class="paramname">evNum</td><td>the EV number (0 for the produced action) </td></tr>
    <tr><td class="paramname">evVal</td><td>the EV value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if success otherwise the error </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a25dbd341349525d3b0917340575378b7" name="a25dbd341349525d3b0917340575378b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25dbd341349525d3b0917340575378b7">&#9670;&#160;</a></span>eventTeachService</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="struct_service.html">Service</a> eventTeachService</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    SERVICE_ID_OLD_TEACH,      </div>
<div class="line">    1,                  </div>
<div class="line">    teachFactoryReset,  </div>
<div class="line">    teachPowerUp,       </div>
<div class="line">    teachProcessMessage,</div>
<div class="line">    NULL,               </div>
<div class="line"> </div>
<div class="line">    NULL,               </div>
<div class="line">    NULL,               </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><p>The service descriptor for the event teach service. The application must include this descriptor within the const <a class="el" href="struct_service.html">Service</a> * const services[] array and include the necessary settings within module.h in order to make use of the event teach service. </p>

</div>
</div>
<a id="a5e104ea2eb5211e43dd69e1092a236a3" name="a5e104ea2eb5211e43dd69e1092a236a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e104ea2eb5211e43dd69e1092a236a3">&#9670;&#160;</a></span>evs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t evs[PARAM_NUM_EV_EVENT]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The EVs for an event after calling <a class="el" href="#a275d5d58705f018ba8ea8a05477ba716">getEVs()</a> </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="event__teach__large_8c.html">event_teach_large.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
