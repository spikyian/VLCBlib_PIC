<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VLCB library: nv.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">VLCB library<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">VLCB C library for PIC</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('nv_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">nv.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of the VLCB NV <a class="el" href="struct_service.html">Service</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;xc.h&gt;</code><br />
<code>#include &quot;<a class="el" href="vlcb_8h_source.html">vlcb.h</a>&quot;</code><br />
<code>#include &quot;module.h&quot;</code><br />
<code>#include &quot;<a class="el" href="nv_8h_source.html">nv.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mns_8h_source.html">mns.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nvm_8h_source.html">nvm.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timed_response_8h_source.html">timedResponse.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a73848e01f235ea24851be0145521f3e1" id="r_a73848e01f235ea24851be0145521f3e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a73848e01f235ea24851be0145521f3e1">loadNvCache</a> (void)</td></tr>
<tr class="separator:a73848e01f235ea24851be0145521f3e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a987db48e91d2960775ec5fae455d31f4" id="r_a987db48e91d2960775ec5fae455d31f4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="timed_response_8h.html#a34f3661bc164f76318500bd6a0fafd48">TimedResponseResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a987db48e91d2960775ec5fae455d31f4">nvTRnvrdCallback</a> (uint8_t type, uint8_t serviceIndex, uint8_t step)</td></tr>
<tr class="separator:a987db48e91d2960775ec5fae455d31f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a763f8f826b59a23e6a2fd211a05765b7" id="r_a763f8f826b59a23e6a2fd211a05765b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a763f8f826b59a23e6a2fd211a05765b7">APP_nvValueChanged</a> (uint8_t index, uint8_t value, uint8_t oldValue)</td></tr>
<tr class="separator:a763f8f826b59a23e6a2fd211a05765b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe82e0f5aaf414e39df9aa403c794a01" id="r_abe82e0f5aaf414e39df9aa403c794a01"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe82e0f5aaf414e39df9aa403c794a01">APP_nvDefault</a> (uint8_t index)</td></tr>
<tr class="separator:abe82e0f5aaf414e39df9aa403c794a01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fc023cbc8a941ab2f33f1d330bf91e8" id="r_a0fc023cbc8a941ab2f33f1d330bf91e8"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0fc023cbc8a941ab2f33f1d330bf91e8">getNV</a> (uint8_t index)</td></tr>
<tr class="separator:a0fc023cbc8a941ab2f33f1d330bf91e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d9d758ea32b02313d80e6f18ecf41fd" id="r_a5d9d758ea32b02313d80e6f18ecf41fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5d9d758ea32b02313d80e6f18ecf41fd">saveNV</a> (uint8_t index, uint8_t value)</td></tr>
<tr class="separator:a5d9d758ea32b02313d80e6f18ecf41fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cc0e4678cce31623f8270897b8b58d4" id="r_a1cc0e4678cce31623f8270897b8b58d4"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1cc0e4678cce31623f8270897b8b58d4">setNV</a> (uint8_t index, uint8_t value)</td></tr>
<tr class="separator:a1cc0e4678cce31623f8270897b8b58d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a54cb92ae67b344b1663b74af93adf6f0" id="r_a54cb92ae67b344b1663b74af93adf6f0"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="struct_service.html">Service</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a54cb92ae67b344b1663b74af93adf6f0">nvService</a></td></tr>
<tr class="separator:a54cb92ae67b344b1663b74af93adf6f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of the VLCB NV <a class="el" href="struct_service.html">Service</a>. </p>
<dl class="section copyright"><dt>Copyright</dt><dd>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.</dd></dl>
<p>The service definition object is called nvService.</p>
<p>The NV service implements the VLCB Node Variable <a class="el" href="struct_service.html">Service</a>. This supports the NVSET, NVRD and NVSETRD opcodes.</p>
<p>If NV_CACHE is defined in module.h then the NV service implements a cache of NV values in RAM. This can be used to speed up obtaining NV values used within the application at the expense of additional RAM usage. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="abe82e0f5aaf414e39df9aa403c794a01" name="abe82e0f5aaf414e39df9aa403c794a01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe82e0f5aaf414e39df9aa403c794a01">&#9670;&#160;</a></span>APP_nvDefault()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t APP_nvDefault </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>index</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to be provided by the application to be called by the VLCB library to determine the application's default value of an NV. </p>

</div>
</div>
<a id="a763f8f826b59a23e6a2fd211a05765b7" name="a763f8f826b59a23e6a2fd211a05765b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a763f8f826b59a23e6a2fd211a05765b7">&#9670;&#160;</a></span>APP_nvValueChanged()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void APP_nvValueChanged </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>index</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>value</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>oldValue</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>nv cache Function to be provided by the application to be called by the VLCB library whenever an NV value is changed. Allows the application to perform special actions upon NV change. </p>

</div>
</div>
<a id="a0fc023cbc8a941ab2f33f1d330bf91e8" name="a0fc023cbc8a941ab2f33f1d330bf91e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fc023cbc8a941ab2f33f1d330bf91e8">&#9670;&#160;</a></span>getNV()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t getNV </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>index</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the value of an NV. Either obtained from the cache or from NVM. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>the NV index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the NV value </dd></dl>

</div>
</div>
<a id="a73848e01f235ea24851be0145521f3e1" name="a73848e01f235ea24851be0145521f3e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73848e01f235ea24851be0145521f3e1">&#9670;&#160;</a></span>loadNvCache()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loadNvCache </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Load the NV cache using values stored in non volatile memory. </p>

</div>
</div>
<a id="a987db48e91d2960775ec5fae455d31f4" name="a987db48e91d2960775ec5fae455d31f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a987db48e91d2960775ec5fae455d31f4">&#9670;&#160;</a></span>nvTRnvrdCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="timed_response_8h.html#a34f3661bc164f76318500bd6a0fafd48">TimedResponseResult</a> nvTRnvrdCallback </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>type</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>serviceIndex</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>step</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the callback used by the service discovery responses. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>always set to TIMED_RESPONSE_NVRD </td></tr>
    <tr><td class="paramname">serviceIndex</td><td>indicates the service requesting the responses </td></tr>
    <tr><td class="paramname">step</td><td>loops through each service to be discovered </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether all of the responses have been sent yet. </dd></dl>

</div>
</div>
<a id="a5d9d758ea32b02313d80e6f18ecf41fd" name="a5d9d758ea32b02313d80e6f18ecf41fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d9d758ea32b02313d80e6f18ecf41fd">&#9670;&#160;</a></span>saveNV()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void saveNV </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>index</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Save (write) the value of an NV. Does no validation and does not call back into the application.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>the NV index </td></tr>
    <tr><td class="paramname">value</td><td>the value of the NV to be written </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1cc0e4678cce31623f8270897b8b58d4" name="a1cc0e4678cce31623f8270897b8b58d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cc0e4678cce31623f8270897b8b58d4">&#9670;&#160;</a></span>setNV()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t setNV </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>index</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set (write) the value of an NV. The module's application is called (APP_nvValidate) to check that the value being written is valid. After updating the NV the application's function APP_nvValueChanged is called so that the application can perform any related checks, changes or functionality.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>the NV index </td></tr>
    <tr><td class="paramname">value</td><td>the value of the NV to be written </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 for no error otherwise the error </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a54cb92ae67b344b1663b74af93adf6f0" name="a54cb92ae67b344b1663b74af93adf6f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54cb92ae67b344b1663b74af93adf6f0">&#9670;&#160;</a></span>nvService</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="struct_service.html">Service</a> nvService</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    SERVICE_ID_NV,      </div>
<div class="line">    1,                  </div>
<div class="line">    nvFactoryReset,     </div>
<div class="line">    nvPowerUp,          </div>
<div class="line">    nvProcessMessage,   </div>
<div class="line">    NULL,               </div>
<div class="line"> </div>
<div class="line">    NULL,               </div>
<div class="line">    NULL,               </div>
<div class="line"> </div>
<div class="line">    nvGetESDdata,       </div>
<div class="line">    nvGetDiagnostic     </div>
<div class="line">}</div>
</div><!-- fragment --><p>The service descriptor for the NV service. The application must include this descriptor within the const <a class="el" href="struct_service.html">Service</a> * const services[] array and include the necessary settings within module.h in order to make use of the Node Variable service. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="nv_8c.html">nv.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
