<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VLCB library: romops.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">VLCB library<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">VLCB C library for PIC</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('romops_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">romops.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a href="romops_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a70d4c3b00923a1469578faa16591a44d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="romops_8h.html#a70d4c3b00923a1469578faa16591a44d">_ROMOPS_H_</a></td></tr>
<tr class="separator:a70d4c3b00923a1469578faa16591a44d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a4e97ec56ed0b3a64f449dfc278703063"><td class="memItemLeft" align="right" valign="top"><a id="a4e97ec56ed0b3a64f449dfc278703063" name="a4e97ec56ed0b3a64f449dfc278703063"></a>
typedef enum ValidTime&#160;</td><td class="memItemRight" valign="bottom"><b>ValidTime</b></td></tr>
<tr class="separator:a4e97ec56ed0b3a64f449dfc278703063"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a4edc8ede417a683709eaaf0ed26f441e"><td class="memItemLeft" align="right" valign="top"><a id="a4edc8ede417a683709eaaf0ed26f441e" name="a4edc8ede417a683709eaaf0ed26f441e"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>NVMtype</b> { <b>EEPROM_NVM_TYPE</b>
, <b>FLASH_NVM_TYPE</b>
 }</td></tr>
<tr class="separator:a4edc8ede417a683709eaaf0ed26f441e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f9845fc137a58b7863796abd20e7b05"><td class="memItemLeft" align="right" valign="top"><a id="a0f9845fc137a58b7863796abd20e7b05" name="a0f9845fc137a58b7863796abd20e7b05"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>ValidTime</b> { <b>BAD_TIME</b> =0
, <b>GOOD_TIME</b> =1
 }</td></tr>
<tr class="separator:a0f9845fc137a58b7863796abd20e7b05"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0fcdc24440e40c3ff3cded548b912008"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="romops_8h.html#a0fcdc24440e40c3ff3cded548b912008">flushFlashBlock</a> (void)</td></tr>
<tr class="separator:a0fcdc24440e40c3ff3cded548b912008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02557928852521f6abecc4d65c6ba12b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="romops_8h.html#a02557928852521f6abecc4d65c6ba12b">initRomOps</a> (void)</td></tr>
<tr class="separator:a02557928852521f6abecc4d65c6ba12b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b5c8c0d5034f4598a4933db88ac3ba2"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="romops_8h.html#a0b5c8c0d5034f4598a4933db88ac3ba2">readNVM</a> (NVMtype type, uint24_t index)</td></tr>
<tr class="separator:a0b5c8c0d5034f4598a4933db88ac3ba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c179e5ce4a0973b69dab3e12edc0eb3"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="romops_8h.html#a6c179e5ce4a0973b69dab3e12edc0eb3">writeNVM</a> (NVMtype type, uint24_t index, uint8_t value)</td></tr>
<tr class="separator:a6c179e5ce4a0973b69dab3e12edc0eb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae34d4d879380e8085b5e975b6186f58e"><td class="memItemLeft" align="right" valign="top">ValidTime&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="romops_8h.html#ae34d4d879380e8085b5e975b6186f58e">APP_isSuitableTimeToWriteFlash</a> (void)</td></tr>
<tr class="separator:ae34d4d879380e8085b5e975b6186f58e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Non volatile memory functions</p>
<p>Functionality for reading and writing to EEPROM and Flash NVM. Read and write to EEPROM is straightforward. Reading from flash is also straightforward but writing to flash is complex. This involves needing to erase a block if changing any bit from 0 to 1 and if changing a single byte the entire block must be read, the byte changed and the entire block written back. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a70d4c3b00923a1469578faa16591a44d" name="a70d4c3b00923a1469578faa16591a44d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70d4c3b00923a1469578faa16591a44d">&#9670;&#160;</a></span>_ROMOPS_H_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _ROMOPS_H_</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section copyright"><dt>Copyright</dt><dd>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Original CANACC8 assembler version (c) Mike Bolton </dd>
<dd>
Modifications to EEPROM routines and conversion to C18 (c) Andrew Crosland </dd>
<dd>
FLASH routines by (c) Chuck Hoelzen </dd>
<dd>
Modifications, refinements &amp; combine EEPROM and FLASH into one module (C) Pete Brownlow 2014-2017 <a href="#" onclick="location.href='mai'+'lto:'+'sof'+'tw'+'are'+'@u'+'psy'+'s.'+'co'; return false;">softw<span class="obfuscator">.nosp@m.</span>are@<span class="obfuscator">.nosp@m.</span>upsys<span class="obfuscator">.nosp@m.</span>.co</a>.u </dd>
<dd>
Major rewrite Ian Hogg <br  />
 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Dec 2022 </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae34d4d879380e8085b5e975b6186f58e" name="ae34d4d879380e8085b5e975b6186f58e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae34d4d879380e8085b5e975b6186f58e">&#9670;&#160;</a></span>APP_isSuitableTimeToWriteFlash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ValidTime APP_isSuitableTimeToWriteFlash </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Call back into the application to check if now is a good time to write the flash as the processor will be suspended for up to 2ms. </p>

</div>
</div>
<a id="a0fcdc24440e40c3ff3cded548b912008" name="a0fcdc24440e40c3ff3cded548b912008"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fcdc24440e40c3ff3cded548b912008">&#9670;&#160;</a></span>flushFlashBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flushFlashBlock </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flush the current flash buffer out to flash. Will suspend the CPU. </p>

</div>
</div>
<a id="a02557928852521f6abecc4d65c6ba12b" name="a02557928852521f6abecc4d65c6ba12b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02557928852521f6abecc4d65c6ba12b">&#9670;&#160;</a></span>initRomOps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initRomOps </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialise variables for Flash program tracking. </p>

</div>
</div>
<a id="a0b5c8c0d5034f4598a4933db88ac3ba2" name="a0b5c8c0d5034f4598a4933db88ac3ba2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b5c8c0d5034f4598a4933db88ac3ba2">&#9670;&#160;</a></span>readNVM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t readNVM </td>
          <td>(</td>
          <td class="paramtype">NVMtype&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint24_t&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read a single byte of NVM. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>the type of memory to be accessed </td></tr>
    <tr><td class="paramname">index</td><td>the address </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the value if &gt;=0, -error otherwise </dd></dl>

</div>
</div>
<a id="a6c179e5ce4a0973b69dab3e12edc0eb3" name="a6c179e5ce4a0973b69dab3e12edc0eb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c179e5ce4a0973b69dab3e12edc0eb3">&#9670;&#160;</a></span>writeNVM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t writeNVM </td>
          <td>(</td>
          <td class="paramtype">NVMtype&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint24_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write a single byte to NVM. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>the type of memory to access </td></tr>
    <tr><td class="paramname">index</td><td>the memory address </td></tr>
    <tr><td class="paramname">value</td><td>the value to be written </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 for success, error otherwise </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="romops_8h.html">romops.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
